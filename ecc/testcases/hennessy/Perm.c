// Generated by Oberon+ IDE (Mono) 0.9.107 on 2024-08-10T01:27:54

#include "Perm.h"

int32_t Perm$permarray[11];
int32_t Perm$pctr = 0;
void Perm$Swap(int32_t * a, int32_t * b) {
    int32_t t;
    t = 0;
    t = (*a);
    (*a) = (*b);
    (*b) = t;
}

void Perm$Initialize() {
    int32_t i;
    struct OBX$Array$1* $t0;
    i = 0;
    i = 1;
    while(1) {
        if( (i <= 7) ) {
            (((int32_t *)((struct OBX$Array$1){11,1,Perm$permarray}).$a)[i]) = (i - 1);
            i++;
        } else {
            break;
        }
    }
}

void Perm$Permute(int32_t n) {
    int32_t k;
    struct OBX$Array$1* $t0;
    struct OBX$Array$1* $t1;
    k = 0;
    Perm$pctr = (Perm$pctr + 1);
    if( (n != 1) ) {
        Perm$Permute((n - 1));
        k = (n - 1);
        while(1) {
            if( (k >= 1) ) {
                Perm$Swap(&(((int32_t *)((struct OBX$Array$1){11,1,Perm$permarray}).$a)[n]), &(((int32_t *)((struct OBX$Array$1){11,1,Perm$permarray}).$a)[k]));
                Perm$Permute((n - 1));
                Perm$Swap(&(((int32_t *)((struct OBX$Array$1){11,1,Perm$permarray}).$a)[n]), &(((int32_t *)((struct OBX$Array$1){11,1,Perm$permarray}).$a)[k]));
                k--;
            } else {
                break;
            }
        }
    } 
}

void Perm$Run() {
    int32_t i;
    i = 0;
    Perm$pctr = 0;
    i = 1;
    while(1) {
        if( (i <= 5) ) {
            Perm$Initialize();
            Perm$Permute(7);
            i++;
        } else {
            break;
        }
    }
    if( (Perm$pctr != 43300) ) {
        Util$Str((const struct OBX$Array$1){17,0,OBX$FromUtf(" Error in Perm.$",17,0)});
    } 
}

static int initDone$ = 0;
void Perm$init$(void) {
    if(initDone$) return; else initDone$ = 1;
    Util$init$();
    memset(&Perm$permarray,0,sizeof(Perm$permarray));
}
OBX$Cmd Perm$cmd$(const char* name) {
    if( name == 0 ) return Perm$init$;
    if( strcmp(name,"Initialize") == 0 ) return Perm$Initialize;
    if( strcmp(name,"Run") == 0 ) return Perm$Run;
    return 0;
}
