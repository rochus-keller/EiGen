// Generated by Oberon+ IDE (Mono) 0.9.107 on 2024-08-10T01:27:54

#include "Queens.h"

void Queens$Try(int32_t i, uint8_t * q, struct OBX$Array$1 a, struct OBX$Array$1 b, struct OBX$Array$1 c, struct OBX$Array$1 x) {
    int32_t j;
    struct OBX$Array$1* $t0;
    struct OBX$Array$1* $t1;
    struct OBX$Array$1* $t2;
    struct OBX$Array$1* $t3;
    j = 0;
    j = 0;
    (*q) = 0;
    while(1) {
        if( ((!(*q)) && (j != 8)) ) {
            j = (j + 1);
            (*q) = 0;
            if( (((*($t0 = (&b),&((uint8_t *)$t0->$a)[j])) && (*($t1 = (&a),&((uint8_t *)$t1->$a)[(i + j)]))) && (*($t2 = (&c),&((uint8_t *)$t2->$a)[((i - j) + 7)]))) ) {
                (*($t3 = (&x),&((int32_t *)$t3->$a)[i])) = j;
                (*($t0 = (&b),&((uint8_t *)$t0->$a)[j])) = 0;
                (*($t0 = (&a),&((uint8_t *)$t0->$a)[(i + j)])) = 0;
                (*($t0 = (&c),&((uint8_t *)$t0->$a)[((i - j) + 7)])) = 0;
                if( (i < 8) ) {
                    Queens$Try((i + 1), &(*q), a, b, c, x);
                    if( (!(*q)) ) {
                        (*($t0 = (&b),&((uint8_t *)$t0->$a)[j])) = 1;
                        (*($t0 = (&a),&((uint8_t *)$t0->$a)[(i + j)])) = 1;
                        (*($t0 = (&c),&((uint8_t *)$t0->$a)[((i - j) + 7)])) = 1;
                    } 
                } else {
                    (*q) = 1;
                }
            } 
        } else {
            break;
        }
    }
}

void Queens$Doit() {
    int32_t i;
    uint8_t q;
    uint8_t a[9];
    uint8_t b[17];
    uint8_t c[15];
    int32_t x[9];
    struct OBX$Array$1* $t0;
    i = 0;
    q = 0;
    memset(&a,0,sizeof(a));
    memset(&b,0,sizeof(b));
    memset(&c,0,sizeof(c));
    memset(&x,0,sizeof(x));
    i = (-7);
    while(1) {
        if( (i <= 16) ) {
            if( ((i >= 1) && (i <= 8)) ) {
                (((uint8_t *)((struct OBX$Array$1){9,1,a}).$a)[i]) = 1;
            } 
            if( (i >= 2) ) {
                (((uint8_t *)((struct OBX$Array$1){17,1,b}).$a)[i]) = 1;
            } 
            if( (i <= 7) ) {
                (((uint8_t *)((struct OBX$Array$1){15,1,c}).$a)[(i + 7)]) = 1;
            } 
            i = (i + 1);
        } else {
            break;
        }
    }
    Queens$Try(1, &q, (struct OBX$Array$1){17,1,b}, (struct OBX$Array$1){9,1,a}, (struct OBX$Array$1){15,1,c}, (struct OBX$Array$1){9,1,x});
    if( (!q) ) {
        Util$Str((const struct OBX$Array$1){19,0,OBX$FromUtf(" Error in Queens.$",19,0)});
    } 
}

void Queens$Run() {
    int32_t i;
    i = 0;
    i = 1;
    while(1) {
        if( (i <= 50) ) {
            Queens$Doit();
            i++;
        } else {
            break;
        }
    }
}

static int initDone$ = 0;
void Queens$init$(void) {
    if(initDone$) return; else initDone$ = 1;
    Util$init$();
}
OBX$Cmd Queens$cmd$(const char* name) {
    if( name == 0 ) return Queens$init$;
    if( strcmp(name,"Doit") == 0 ) return Queens$Doit;
    if( strcmp(name,"Run") == 0 ) return Queens$Run;
    return 0;
}
